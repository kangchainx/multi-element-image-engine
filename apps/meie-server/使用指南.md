# ComfyUI API Demo ä½¿ç”¨æŒ‡å—

## ğŸ“‹ è¿™ä¸ªé¡¹ç›®æ˜¯åšä»€ä¹ˆçš„ï¼Ÿ

è¿™æ˜¯ä¸€ä¸ª**ç”¨ä»£ç è°ƒç”¨ComfyUI**çš„æ¼”ç¤ºé¡¹ç›®ã€‚é€šå¸¸ä½ ä½¿ç”¨ComfyUIçš„Webç•Œé¢æ¥ç”Ÿæˆå›¾ç‰‡ï¼Œä½†è¿™ä¸ªé¡¹ç›®å±•ç¤ºäº†å¦‚ä½•**ç”¨TypeScriptä»£ç è‡ªåŠ¨åŒ–è¿™ä¸ªè¿‡ç¨‹**ã€‚

## ğŸ”„ å·¥ä½œæµç¨‹å›¾è§£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. ComfyUI     â”‚  â† ä½ éœ€è¦å…ˆå¯åŠ¨ComfyUIï¼ˆå·²å¯åŠ¨âœ…ï¼‰
â”‚  æœåŠ¡å™¨è¿è¡Œ     â”‚    åœ°å€: http://127.0.0.1:8000
â”‚  ç«¯å£: 8000     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. ä½ åœ¨ComfyUI â”‚                  â”‚  3. å¯¼å‡ºworkflowâ”‚
â”‚  ç•Œé¢è®¾è®¡workflowâ”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>    â”‚  ä¿å­˜ä¸ºJSONæ–‡ä»¶ â”‚
â”‚  (æ‹–æ‹½èŠ‚ç‚¹ã€è®¾ç½®)â”‚                  â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                              â”‚
                                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
                                     â”‚ Unsaved         â”‚
                                     â”‚ Workflow.json   â”‚
                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                              â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. è¿è¡Œdemo.ts â”‚  â† npm start
â”‚                 â”‚
â”‚  è¯»å–JSONæ–‡ä»¶   â”‚
â”‚  â†“              â”‚
â”‚  è°ƒç”¨APIæäº¤    â”‚
â”‚  â†“              â”‚
â”‚  ç­‰å¾…ç”Ÿæˆå®Œæˆ   â”‚
â”‚  â†“              â”‚
â”‚  æ˜¾ç¤ºç»“æœ       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  5. å›¾ç‰‡ç”Ÿæˆ    â”‚
â”‚  ä¿å­˜åœ¨:        â”‚
â”‚  /Users/chris/  â”‚
â”‚  Documents/     â”‚
â”‚  ComfyUI/output â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ è¯¦ç»†ä½¿ç”¨æ­¥éª¤

### æ­¥éª¤1: ç¡®è®¤ComfyUIè¿è¡Œï¼ˆâœ… å·²å®Œæˆï¼‰

ä½ çš„ComfyUIå·²ç»åœ¨è¿è¡Œï¼š
- **åœ°å€**: http://127.0.0.1:8000
- **ç‰ˆæœ¬**: 0.12.2
- **è¾“å‡ºç›®å½•**: `/Users/chris/Documents/ComfyUI/output`

### æ­¥éª¤2: åœ¨ComfyUIä¸­è®¾è®¡workflowï¼ˆâœ… å·²æœ‰ï¼‰

ä½ å·²ç»æœ‰ä¸€ä¸ª `Unsaved Workflow.json` æ–‡ä»¶ï¼Œå†…å®¹æ˜¯ï¼š
- **æ¨¡å‹**: v1-5-pruned-emaonly-fp16.safetensors
- **æç¤ºè¯**: "beautiful scenery nature glass bottle landscape, purple galaxy bottle"
- **è´Ÿé¢æç¤ºè¯**: "text, watermark"
- **å›¾ç‰‡å°ºå¯¸**: 512x512
- **é‡‡æ ·æ­¥æ•°**: 20æ­¥

å¦‚æœä½ æƒ³ä¿®æ”¹workflowï¼š
1. æ‰“å¼€ComfyUIç•Œé¢: http://127.0.0.1:8000
2. è®¾è®¡æˆ–ä¿®æ”¹ä½ çš„workflow
3. ç‚¹å‡»å³ä¸Šè§’çš„"Save"æŒ‰é’® â†’ "Export (API Format)"
4. ä¿å­˜ä¸º `Unsaved Workflow.json`ï¼ˆæ›¿æ¢ç°æœ‰æ–‡ä»¶ï¼‰

### æ­¥éª¤3: è¿è¡Œè¿™ä¸ªTypeScriptç¨‹åº

åœ¨ç»ˆç«¯æ‰§è¡Œï¼š

```bash
cd /Users/chris/Documents/GitHub/comfy-test
npm start
```

### æ­¥éª¤4: ç¨‹åºä¼šè‡ªåŠ¨å®Œæˆä»¥ä¸‹æ“ä½œ

```
=== ComfyUI API Demo ===
Client ID: xxx-xxx-xxx

[1/4] Loading workflow...
Model: v1-5-pruned-emaonly-fp16.safetensors
Prompt: beautiful scenery nature glass bottle landscape...
Size: 512x512
Steps: 20

[2/4] Submitting workflow to ComfyUI...
âœ“ Workflow submitted successfully
  Prompt ID: xxx-xxx-xxx
  Queue Number: 1

[3/4] Waiting for execution to complete...
âœ“ Execution finished

[4/4] Processing results...
=== Execution Results ===
âœ“ Status: Completed successfully

=== Generated Images ===
Image 1:
  Filename: ComfyUI_00001_.png
  Subfolder:
  Type: output

=== Demo Complete ===
Check your ComfyUI output directory for generated images.
```

### æ­¥éª¤5: æŸ¥çœ‹ç”Ÿæˆçš„å›¾ç‰‡

å›¾ç‰‡ä¿å­˜åœ¨ï¼š
```
/Users/chris/Documents/ComfyUI/output/ComfyUI_00001_.png
```

## ğŸ’¡ å®é™…åº”ç”¨åœºæ™¯

è¿™ä¸ªdemoå¯ä»¥ç”¨äºï¼š

1. **æ‰¹é‡ç”Ÿæˆå›¾ç‰‡** - ä¿®æ”¹ä»£ç ï¼Œå¾ªç¯æäº¤å¤šä¸ªä¸åŒçš„prompt
2. **è‡ªåŠ¨åŒ–å·¥ä½œæµ** - é›†æˆåˆ°ä½ çš„åº”ç”¨ä¸­ï¼Œè‡ªåŠ¨ç”Ÿæˆå›¾ç‰‡
3. **APIé›†æˆ** - ä½œä¸ºåç«¯æœåŠ¡ï¼Œæ¥æ”¶è¯·æ±‚åè°ƒç”¨ComfyUIç”Ÿæˆå›¾ç‰‡
4. **æŠ€æœ¯é¢è¯•å±•ç¤º** - å±•ç¤ºä½ å¯¹APIé›†æˆã€å¼‚æ­¥ç¼–ç¨‹ã€TypeScriptçš„æŒæ¡

## ğŸ§ª ç°åœ¨è¯•è¯•çœ‹

è¿è¡Œè¿™ä¸ªå‘½ä»¤æµ‹è¯•ï¼š

```bash
npm start
```

ç¨ç­‰20-30ç§’ï¼ˆç”Ÿæˆå›¾ç‰‡éœ€è¦æ—¶é—´ï¼‰ï¼Œä½ ä¼šçœ‹åˆ°ï¼š
- ç¨‹åºè¯»å–workflowé…ç½®
- æäº¤åˆ°ComfyUIæœåŠ¡å™¨
- ç­‰å¾…ç”Ÿæˆå®Œæˆ
- æ˜¾ç¤ºç”Ÿæˆçš„å›¾ç‰‡æ–‡ä»¶å

ç„¶åæ‰“å¼€ `/Users/chris/Documents/ComfyUI/output/` æ–‡ä»¶å¤¹ï¼Œä½ ä¼šçœ‹åˆ°æ–°ç”Ÿæˆçš„å›¾ç‰‡ï¼

## ğŸ”§ å¦‚æœæƒ³ä¿®æ”¹é…ç½®

ç¼–è¾‘ `demo.ts` æ–‡ä»¶ï¼š

```typescript
// ä¿®æ”¹ç«¯å£ï¼ˆå½“å‰æ˜¯8000ï¼‰
const COMFYUI_API_BASE = 'http://127.0.0.1:8000';

// ä¿®æ”¹workflowæ–‡ä»¶è·¯å¾„
const WORKFLOW_FILE_PATH = './Unsaved Workflow.json';

// ä¿®æ”¹è¶…æ—¶æ—¶é—´ï¼ˆå½“å‰60ç§’ï¼‰
const MAX_POLL_ATTEMPTS = 60;
```

## â“ å¸¸è§é—®é¢˜

**Q: ä¸ºä»€ä¹ˆè¦ç”¨ä»£ç è€Œä¸æ˜¯ç›´æ¥ç”¨ComfyUIç•Œé¢ï¼Ÿ**
A: ä»£ç å¯ä»¥è‡ªåŠ¨åŒ–ã€æ‰¹é‡å¤„ç†ã€é›†æˆåˆ°å…¶ä»–åº”ç”¨ä¸­ã€‚æ¯”å¦‚ä½ å¯ä»¥åšä¸€ä¸ªç½‘ç«™ï¼Œç”¨æˆ·è¾“å…¥æç¤ºè¯ï¼Œåå°è°ƒç”¨ComfyUIç”Ÿæˆå›¾ç‰‡ã€‚

**Q: workflow JSONæ–‡ä»¶æ˜¯ä»€ä¹ˆï¼Ÿ**
A: è¿™æ˜¯ComfyUIçš„å·¥ä½œæµé…ç½®æ–‡ä»¶ï¼ŒåŒ…å«äº†æ‰€æœ‰èŠ‚ç‚¹ï¼ˆæ¨¡å‹ã€é‡‡æ ·å™¨ã€æç¤ºè¯ç­‰ï¼‰çš„è®¾ç½®ã€‚å°±åƒæ˜¯ä¸€ä¸ª"é…æ–¹"ï¼Œå‘Šè¯‰ComfyUIå¦‚ä½•ç”Ÿæˆå›¾ç‰‡ã€‚

**Q: å¯ä»¥ä¿®æ”¹æç¤ºè¯å—ï¼Ÿ**
A: å¯ä»¥ï¼ä½ å¯ä»¥ï¼š
1. ä¿®æ”¹ `Unsaved Workflow.json` ä¸­çš„ `text` å­—æ®µ
2. æˆ–è€…åœ¨ `demo.ts` ä¸­ä¿®æ”¹workflowå¯¹è±¡åå†æäº¤

**Q: éœ€è¦è®­ç»ƒæ¨¡å‹å—ï¼Ÿ**
A: ä¸éœ€è¦ï¼è¿™ä¸ªdemoåªæ˜¯è°ƒç”¨ComfyUIï¼Œä½¿ç”¨çš„æ˜¯ComfyUIå·²ç»åŠ è½½çš„æ¨¡å‹ã€‚
